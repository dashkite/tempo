var Amen, assert, next, observe, promise, value;
assert = require("assert");
Amen = require("amen");
({
  promise
} = require("panda-parchment"));
({
  next,
  value
} = require("../src/iterator"));
({
  observe
} = require("../src/observe"));
Amen.describe("Observe", function (context) {
  return context.test("change events", function* () {
    var proxy, reactor;
    ({
      proxy,
      reactor
    } = observe({
      value: 7
    }));
    setImmediate(function () {
      return proxy.value = 3;
    });
    assert.deepEqual({
      value: 3
    }, value((yield next(reactor))));

    (function (proxy, reactor) {
      return context.test("nested change events", function* () {
        ({
          proxy,
          reactor
        } = observe({
          value: {
            value: 7
          }
        }));
        setImmediate(function () {
          return proxy.value.value = 5;
        });
        return assert.deepEqual({
          value: {
            value: 5
          }
        }, value((yield next(reactor))));
      });
    })(proxy, reactor);

    return function (proxy, reactor) {
      return context.test("for arrays", function* () {
        ({
          proxy,
          reactor
        } = observe([1, 2, 3, 4, 5]));
        setImmediate(function () {
          return proxy.shift();
        });
        return assert.deepEqual([2, 3, 4, 5], value((yield next(reactor))));
      });
    }(proxy, reactor);
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9kYXZpZC9yZXBvcy9wYW5kYS1yaXZlci90ZXN0L29ic2VydmUuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLElBQUEsSUFBQSxFQUFBLE1BQUEsRUFBQSxJQUFBLEVBQUEsT0FBQSxFQUFBLE9BQUEsRUFBQSxLQUFBO0FBQUEsTUFBQSxHQUFTLE9BQUEsQ0FBQSxRQUFBLENBQVQ7QUFDQSxJQUFBLEdBQU8sT0FBQSxDQUFBLE1BQUEsQ0FBUDtBQUNBLENBQUE7QUFBQSxFQUFBO0FBQUEsSUFBWSxPQUFBLENBQVosaUJBQVksQ0FBWjtBQUVBLENBQUE7QUFBQSxFQUFBLElBQUE7QUFBQSxFQUFBO0FBQUEsSUFBZ0IsT0FBQSxDQUFoQixpQkFBZ0IsQ0FBaEI7QUFDQSxDQUFBO0FBQUEsRUFBQTtBQUFBLElBQVksT0FBQSxDQUFaLGdCQUFZLENBQVo7QUFFQSxJQUFJLENBQUosUUFBQSxDQUFBLFNBQUEsRUFBeUIsVUFBQSxPQUFBLEVBQUE7U0FDdkIsT0FBTyxDQUFQLElBQUEsQ0FBQSxlQUFBLEVBQThCLGFBQUE7QUFDNUIsUUFBQSxLQUFBLEVBQUEsT0FBQTtBQUFBLEtBQUE7QUFBQSxNQUFBLEtBQUE7QUFBQSxNQUFBO0FBQUEsUUFBbUIsT0FBQSxDQUFRO0FBQUEsTUFBQSxLQUFBLEVBQU87QUFBUCxLQUFSLENBQW5CO0FBQ0EsSUFBQSxZQUFBLENBQWEsWUFBQTthQUFHLEtBQUssQ0FBTCxLQUFBLEdBQWMsQztBQUE5QixLQUFBLENBQUE7QUFDQSxJQUFBLE1BQU0sQ0FBTixTQUFBLENBQWlCO0FBQUEsTUFBQSxLQUFBLEVBQU87QUFBUCxLQUFqQixFQUNFLEtBQUEsRUFBTSxNQUFNLElBQUEsQ0FEZCxPQUNjLENBQVosRUFERjs7QUFHRyxLQUFBLFVBQUEsS0FBQSxFQUFBLE9BQUEsRUFBQTthQUNELE9BQU8sQ0FBUCxJQUFBLENBQUEsc0JBQUEsRUFBcUMsYUFBQTtBQUNuQyxTQUFBO0FBQUEsVUFBQSxLQUFBO0FBQUEsVUFBQTtBQUFBLFlBQW1CLE9BQUEsQ0FBUTtBQUFBLFVBQUEsS0FBQSxFQUFPO0FBQUEsWUFBQSxLQUFBLEVBQU87QUFBUDtBQUFQLFNBQVIsQ0FBbkI7QUFDQSxRQUFBLFlBQUEsQ0FBYSxZQUFBO2lCQUFHLEtBQUssQ0FBQyxLQUFOLENBQUEsS0FBQSxHQUFvQixDO0FBQXBDLFNBQUEsQ0FBQTtlQUNBLE1BQU0sQ0FBTixTQUFBLENBQWlCO0FBQUEsVUFBQSxLQUFBLEVBQU87QUFBQSxZQUFBLEtBQUEsRUFBTztBQUFQO0FBQVAsU0FBakIsRUFDRSxLQUFBLEVBQU0sTUFBTSxJQUFBLENBRGQsT0FDYyxDQUFaLEVBREYsQztBQUhGLE9BQUEsQztBQURGLEtBQUcsRUFBSCxLQUFHLEVBQUgsT0FBRzs7V0FPQSxVQUFBLEtBQUEsRUFBQSxPQUFBLEVBQUE7YUFDRCxPQUFPLENBQVAsSUFBQSxDQUFBLFlBQUEsRUFBMkIsYUFBQTtBQUN6QixTQUFBO0FBQUEsVUFBQSxLQUFBO0FBQUEsVUFBQTtBQUFBLFlBQW1CLE9BQUEsQ0FBUSxDQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBM0IsQ0FBMkIsQ0FBUixDQUFuQjtBQUNBLFFBQUEsWUFBQSxDQUFhLFlBQUE7aUJBQUcsS0FBSyxDQUFMLEtBQUEsRTtBQUFoQixTQUFBLENBQUE7ZUFDQSxNQUFNLENBQU4sU0FBQSxDQUFpQixDQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFqQixDQUFpQixDQUFqQixFQUNFLEtBQUEsRUFBTSxNQUFNLElBQUEsQ0FEZCxPQUNjLENBQVosRUFERixDO0FBSEYsT0FBQSxDO0FBREYsS0FBRyxDQUFILEtBQUcsRUFBSCxPQUFHLEM7QUFiTCxHQUFBLEM7QUFERixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiYXNzZXJ0ID0gcmVxdWlyZSBcImFzc2VydFwiXG5BbWVuID0gcmVxdWlyZSBcImFtZW5cIlxue3Byb21pc2V9ID0gcmVxdWlyZSBcInBhbmRhLXBhcmNobWVudFwiXG5cbntuZXh0LCB2YWx1ZX0gPSByZXF1aXJlIFwiLi4vc3JjL2l0ZXJhdG9yXCJcbntvYnNlcnZlfSA9IHJlcXVpcmUgXCIuLi9zcmMvb2JzZXJ2ZVwiXG5cbkFtZW4uZGVzY3JpYmUgXCJPYnNlcnZlXCIsIChjb250ZXh0KSAtPlxuICBjb250ZXh0LnRlc3QgXCJjaGFuZ2UgZXZlbnRzXCIsIC0+XG4gICAge3Byb3h5LCByZWFjdG9yfSA9IG9ic2VydmUgdmFsdWU6IDdcbiAgICBzZXRJbW1lZGlhdGUgLT4gcHJveHkudmFsdWUgPSAzXG4gICAgYXNzZXJ0LmRlZXBFcXVhbCB2YWx1ZTogMyxcbiAgICAgIHZhbHVlIHlpZWxkIG5leHQgcmVhY3RvclxuXG4gICAgZG8gKHByb3h5LCByZWFjdG9yKSAtPlxuICAgICAgY29udGV4dC50ZXN0IFwibmVzdGVkIGNoYW5nZSBldmVudHNcIiwgLT5cbiAgICAgICAge3Byb3h5LCByZWFjdG9yfSA9IG9ic2VydmUgdmFsdWU6IHZhbHVlOiA3XG4gICAgICAgIHNldEltbWVkaWF0ZSAtPiBwcm94eS52YWx1ZS52YWx1ZSA9IDVcbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbCB2YWx1ZTogdmFsdWU6IDUsXG4gICAgICAgICAgdmFsdWUgeWllbGQgbmV4dCByZWFjdG9yXG5cbiAgICBkbyAocHJveHksIHJlYWN0b3IpIC0+XG4gICAgICBjb250ZXh0LnRlc3QgXCJmb3IgYXJyYXlzXCIsIC0+XG4gICAgICAgIHtwcm94eSwgcmVhY3Rvcn0gPSBvYnNlcnZlIFsxLi41XVxuICAgICAgICBzZXRJbW1lZGlhdGUgLT4gcHJveHkuc2hpZnQoKVxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsIFsyLi41XSxcbiAgICAgICAgICB2YWx1ZSB5aWVsZCBuZXh0IHJlYWN0b3JcbiJdLCJzb3VyY2VSb290IjoiIn0=
//# sourceURL=/Users/david/repos/panda-river/test/observe.coffee