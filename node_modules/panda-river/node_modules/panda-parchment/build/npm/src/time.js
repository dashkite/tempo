"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.times = exports.benchmark = exports.microseconds = exports.timer = exports.sleep = void 0;

var _pandaGarden = require("panda-garden");

var _pandaGenerics = _interopRequireDefault(require("panda-generics"));

var _promise = require("./promise");

var _type = require("./type");

var _string = require("./string");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var benchmark, create, define, microseconds, sleep, timer, times;
exports.times = times;
exports.timer = timer;
exports.sleep = sleep;
exports.microseconds = microseconds;
exports.benchmark = benchmark;
({
  create,
  define
} = _pandaGenerics.default);

exports.timer = timer = function (wait, action) {
  var id;
  id = setTimeout(action, wait);
  return function () {
    return clearTimeout(id);
  };
};

exports.sleep = sleep = function (interval) {
  return (0, _promise.promise)(function (resolve, reject) {
    return timer(interval, function () {
      return resolve();
    });
  });
};

exports.times = times = (0, _pandaGarden.curry)(function (fn, n) {
  var results;
  results = [];

  while (n-- !== 0) {
    results.push(fn());
  }

  return results;
});

exports.microseconds = microseconds = function () {
  var ref;

  if ((typeof process !== "undefined" && process !== null ? process.hrtime : void 0) != null) {
    return function () {
      var nanoseconds, seconds;
      [seconds, nanoseconds] = process.hrtime();
      return seconds * 1000000 + nanoseconds / 1000;
    };
  } else if ((typeof window !== "undefined" && window !== null ? (ref = window.performance) != null ? ref.now : void 0 : void 0) != null) {
    return function () {
      return window.performance.now();
    };
  } else {
    return function () {
      return Date.now() * 1000;
    };
  }
}();

exports.benchmark = benchmark = create({
  name: "benchmark",
  description: "Times a function's execution with up to microsecond resolution"
});
define(benchmark, _type.isFunction, function (fn) {
  var start;
  start = microseconds();
  fn();
  return microseconds() - start;
});
define(benchmark, _type.isAsyncFunction, async function (fn) {
  var start;
  start = microseconds();
  await fn();
  return microseconds() - start;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9kYXZpZC9yZXBvcy9wYW5kYS1wYXJjaG1lbnQvc3JjL3RpbWUuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7OztBQUpBLElBQUEsU0FBQSxFQUFBLE1BQUEsRUFBQSxNQUFBLEVBQUEsWUFBQSxFQUFBLEtBQUEsRUFBQSxLQUFBLEVBQUEsS0FBQTs7Ozs7O0FBTUEsQ0FBQTtBQUFBLEVBQUEsTUFBQTtBQUFBLEVBQUE7QUFBQSxJQUFBLHNCQUFBOztBQUVBLGdCQUFBLEtBQUEsR0FBUSxVQUFBLElBQUEsRUFBQSxNQUFBLEVBQUE7QUFDTixNQUFBLEVBQUE7QUFBQSxFQUFBLEVBQUEsR0FBSyxVQUFBLENBQUEsTUFBQSxFQUFBLElBQUEsQ0FBTDtTQUNBLFlBQUE7V0FBRyxZQUFBLENBQUEsRUFBQSxDO0FBQUgsRztBQUZNLENBQVI7O0FBSUEsZ0JBQUEsS0FBQSxHQUFRLFVBQUEsUUFBQSxFQUFBO1NBQ04sc0JBQVEsVUFBQSxPQUFBLEVBQUEsTUFBQSxFQUFBO1dBQ04sS0FBQSxDQUFBLFFBQUEsRUFBZ0IsWUFBQTthQUFHLE9BQUEsRTtBQUFuQixLQUFBLEM7QUFERixHQUFBLEM7QUFETSxDQUFSOztBQUlBLGdCQUFBLEtBQUEsR0FBUSx3QkFBTSxVQUFBLEVBQUEsRUFBQSxDQUFBLEVBQUE7QUFBVyxNQUFBLE9BQUE7QUFBSyxFQUFBLE9BQUEsR0FBQSxFQUFBOztTQUFNLENBQUEsT0FBTixDLEVBQUE7aUJBQUwsRUFBQSxFO0FBQUs7OztBQUF0QixDQUFBLENBQVI7O0FBRUEsdUJBQUEsWUFBQSxHQUFrQixZQUFBO0FBQ2hCLE1BQUEsR0FBQTs7QUFBQSxNQUFHLENBQUEsT0FBQSxPQUFBLEtBQUEsV0FBQSxJQUFBLE9BQUEsS0FBQSxJQUFBLEdBQUEsT0FBQSxDQUFBLE1BQUEsR0FBQSxLQUFBLENBQUEsS0FBSCxJQUFBLEVBQUE7V0FDRSxZQUFBO0FBQ0UsVUFBQSxXQUFBLEVBQUEsT0FBQTtBQUFBLE9BQUEsT0FBQSxFQUFBLFdBQUEsSUFBeUIsT0FBTyxDQUFQLE1BQUEsRUFBekI7YUFDQSxPQUFBLEdBQUEsT0FBQSxHQUFvQixXQUFBLEdBQWMsSTtBQUh0QyxLO0FBQUEsR0FBQSxNQUlLLElBQUcsQ0FBQSxPQUFBLE1BQUEsS0FBQSxXQUFBLElBQUEsTUFBQSxLQUFBLElBQUEsR0FBQSxDQUFBLEdBQUEsR0FBQSxNQUFBLENBQUEsV0FBQSxLQUFBLElBQUEsR0FBQSxHQUFBLENBQUEsR0FBQSxHQUFBLEtBQUEsQ0FBQSxHQUFBLEtBQUEsQ0FBQSxLQUFILElBQUEsRUFBQTtXQUNILFlBQUE7YUFBRyxNQUFNLENBQUMsV0FBUCxDQUFBLEdBQUEsRTtBQURBLEs7QUFBQSxHQUFBLE1BQUE7V0FHSCxZQUFBO2FBQUcsSUFBSSxDQUFKLEdBQUEsS0FBYSxJO0FBSGIsSzs7QUFMUSxDQUFHLEVBQWxCOztBQVVBLG9CQUFBLFNBQUEsR0FBWSxNQUFBLENBQ1Y7QUFBQSxFQUFBLElBQUEsRUFBQSxXQUFBO0FBQ0EsRUFBQSxXQUFBLEVBQWE7QUFEYixDQURVLENBQVo7QUFJQSxNQUFBLENBQUEsU0FBQSxFQUFBLGdCQUFBLEVBQThCLFVBQUEsRUFBQSxFQUFBO0FBQzVCLE1BQUEsS0FBQTtBQUFBLEVBQUEsS0FBQSxHQUFRLFlBQUEsRUFBUjtBQUNBLEVBQUEsRUFBQTtTQUNBLFlBQUEsS0FBaUIsSztBQUhuQixDQUFBLENBQUE7QUFLQSxNQUFBLENBQUEsU0FBQSxFQUFBLHFCQUFBLEVBQW1DLGdCQUFBLEVBQUEsRUFBQTtBQUNqQyxNQUFBLEtBQUE7QUFBQSxFQUFBLEtBQUEsR0FBUSxZQUFBLEVBQVI7QUFDQSxRQUFNLEVBQUEsRUFBTjtTQUNBLFlBQUEsS0FBaUIsSztBQUhuQixDQUFBLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2N1cnJ5fSBmcm9tIFwicGFuZGEtZ2FyZGVuXCJcbmltcG9ydCBNZXRob2QgZnJvbSBcInBhbmRhLWdlbmVyaWNzXCJcbmltcG9ydCB7cHJvbWlzZSwgYXN5bmN9IGZyb20gXCIuL3Byb21pc2VcIlxuaW1wb3J0IHtpc0FycmF5LCBpc1N0cmluZywgaXNPYmplY3QsIGlzRnVuY3Rpb24sIGlzQXN5bmNGdW5jdGlvbn0gZnJvbSBcIi4vdHlwZVwiXG5pbXBvcnQge2JsYW5rfSBmcm9tIFwiLi9zdHJpbmdcIlxuXG57Y3JlYXRlLCBkZWZpbmV9ID0gTWV0aG9kXG5cbnRpbWVyID0gKHdhaXQsIGFjdGlvbikgLT5cbiAgaWQgPSBzZXRUaW1lb3V0KGFjdGlvbiwgd2FpdClcbiAgLT4gY2xlYXJUaW1lb3V0KCBpZCApXG5cbnNsZWVwID0gKGludGVydmFsKSAtPlxuICBwcm9taXNlIChyZXNvbHZlLCByZWplY3QpIC0+XG4gICAgdGltZXIgaW50ZXJ2YWwsIC0+IHJlc29sdmUoKVxuXG50aW1lcyA9IGN1cnJ5IChmbiwgbikgLT4gZm4oKSB1bnRpbCBuLS0gPT0gMFxuXG5taWNyb3NlY29uZHMgPSBkbyAtPlxuICBpZiBwcm9jZXNzPy5ocnRpbWU/XG4gICAgLT5cbiAgICAgIFtzZWNvbmRzLCBuYW5vc2Vjb25kc10gPSBwcm9jZXNzLmhydGltZSgpXG4gICAgICBzZWNvbmRzICogMTAwMDAwMCArIG5hbm9zZWNvbmRzIC8gMTAwMFxuICBlbHNlIGlmIHdpbmRvdz8ucGVyZm9ybWFuY2U/Lm5vdz9cbiAgICAtPiB3aW5kb3cucGVyZm9ybWFuY2Uubm93KClcbiAgZWxzZVxuICAgIC0+IERhdGUubm93KCkgKiAxMDAwXG5cbmJlbmNobWFyayA9IGNyZWF0ZVxuICBuYW1lOiBcImJlbmNobWFya1wiXG4gIGRlc2NyaXB0aW9uOiBcIlRpbWVzIGEgZnVuY3Rpb24ncyBleGVjdXRpb24gd2l0aCB1cCB0byBtaWNyb3NlY29uZCByZXNvbHV0aW9uXCJcblxuZGVmaW5lIGJlbmNobWFyaywgaXNGdW5jdGlvbiwgKGZuKSAtPlxuICBzdGFydCA9IG1pY3Jvc2Vjb25kcygpXG4gIGZuKClcbiAgbWljcm9zZWNvbmRzKCkgLSBzdGFydFxuXG5kZWZpbmUgYmVuY2htYXJrLCBpc0FzeW5jRnVuY3Rpb24sIChmbikgLT5cbiAgc3RhcnQgPSBtaWNyb3NlY29uZHMoKVxuICBhd2FpdCBmbigpXG4gIG1pY3Jvc2Vjb25kcygpIC0gc3RhcnRcblxuZXhwb3J0IHtzbGVlcCwgdGltZXIsIG1pY3Jvc2Vjb25kcywgYmVuY2htYXJrLCB0aW1lc31cbiJdLCJzb3VyY2VSb290IjoiIn0=
//# sourceURL=/Users/david/repos/panda-parchment/src/time.coffee